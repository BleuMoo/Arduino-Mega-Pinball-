#include <Wire.h> 
#include <LCD_I2C.h>

#include <SPI.h>
#include  <SdFat.h>
#include <FreeStack.h>
//and the MP3 Shield Library
//#include  <SFEMP3Shield.h>
#include <EEPROMex.h>
#include <Arduino.h>

//SdFat sd;     //May add SD card to store the scores
//SFEMP3Shield  MP3player;//May add MP3 player

LCD_I2C lcd(0x27, 20, 4);  // Set the LCD I2C address


long score = 0; 
int MaxBalls = 5;
long RecordScore;
int gameOn = 0;
int relay_count = 16;

int relay[]={22,23,24,25,26,27,28,29,30,31,32,33,4,35,36,37}; //relay outout
int point[]={40,41,42,43,44,45,46,47,48,49,50,51,52,53}; //inputs to collect points

int Start = 16;
int Stop = 17;
int Reset = 18;


void setup() {
  Serial.begin(9600);
  lcd.begin();
  lcd.backlight();
  lcd.clear();
  lcd.print("SPACE CATS");
  lcd.setCursor(0,1);
  lcd.print("Let's Play");
  delay(5000);
  lcd.clear();
  //still need to declear I/Os pinMode
}

void loop() {
 
  if(Start == 1 && MaxBalls != 0 && gameOn==0){
    gameOn = 1;
    lcd.clear();
    lcd.print("Game starting");
    delay(5000);
  }
 

 
  if(gameOn == 1){
    lcd.print("Game ON Get Ready!");
    delay(750);
    //relese the ball
    MaxBalls - 1;
    lcd.print("Balls left" );
    lcd.print(MaxBalls);
    game();
  }

}
void game(){
  //game will happen here

  
  while(Reset ==1){   //reset button has been pressed for 5s. and program going to main loop
    lcd.clear();
    lcd.print("Game reseting");   
    delay(5000);
    return;
  }
  gameOn = 0;//wehen you lose gameOn chages to 0 and program going back to main loop
  void loop();
}

void ScoreDisplay(){
  lcd.clear();
  lcd.setCursor(5,0);
  lcd.print("SPACE CATS");
  lcd.setCursor(0,1);
  lcd.print("SCORE:");  //Dispaly score
  lcd.setCursor(8,1);
  lcd.print(score);
  lcd.setCursor(0,2);
  lcd.print("Balls:");
  lcd.setCursor(8,2);
  lcd.print(MaxBalls);
  
  delayMicroseconds(10);
}

void GameOver(){
  lcd.clear();
  lcd.setCursor(5, 0);
  lcd.print("GAME OVER");
  lcd.setCursor(0, 1);
  lcd.print("Score:");
  lcd.setCursor(6, 0);
  lcd.print(score);
  RecordScore = EEPROM.read(1);
  delayMicroseconds(10);
  if(score > RecordScore){
    lcd.print("New Record!!");
  //  digitalWrite(pin x, HIGH); //Do something with I/Os
    lcd.setCursor(0, 1);
    lcd.print(score);
    EEPROM.update(1, score); //update record points to eeprom
    delay(10000); // wait 10s to do something
  }
  ResetGame();
  
}
void ResetGame(){
  score = 0;
  MaxBalls = 3;
  lcd.setCursor(0,0);
  lcd.print("SPACE CATS");  //Game reset
  lcd.setCursor(0,1);
  lcd.print("Let's Play!");
}
